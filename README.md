Some code was supplied. Some code was written by Neil Edelman.
